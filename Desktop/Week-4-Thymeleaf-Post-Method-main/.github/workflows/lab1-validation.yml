name: Lab 1 - AboutController Validation

on:
  pull_request:
    branches: [ main ]

jobs:
  validate-about-controller:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      
      - name: Check if AboutController exists
        id: check_controller
        run: |
          if [ -f "src/main/java/com/example/Thymeleaf/Demo/controllers/AboutController.java" ]; then
            echo "controller_exists=true" >> $GITHUB_OUTPUT
            echo "✓ AboutController.java found"
          else
            echo "controller_exists=false" >> $GITHUB_OUTPUT
            echo "✗ AboutController.java NOT found"
            exit 1
          fi
      
      - name: Verify /about path is mapped
        id: check_path
        run: |
          if grep -q '@GetMapping("/about")' src/main/java/com/example/Thymeleaf/Demo/controllers/AboutController.java; then
            echo "path_correct=true" >> $GITHUB_OUTPUT
            echo "✓ @GetMapping(\"/about\") found"
          elif grep -q '@RequestMapping("/about")' src/main/java/com/example/Thymeleaf/Demo/controllers/AboutController.java; then
            echo "path_correct=true" >> $GITHUB_OUTPUT
            echo "✓ @RequestMapping(\"/about\") found"
          else
            echo "path_correct=false" >> $GITHUB_OUTPUT
            echo "✗ /about path NOT found in AboutController"
            exit 1
          fi
      
      - name: Check if About link is in navbar
        id: check_navbar
        run: |
          if grep -q '@{/about}' src/main/resources/templates/fragments/navbar.html; then
            echo "navbar_updated=true" >> $GITHUB_OUTPUT
            echo "✓ About link found in navbar"
          else
            echo "navbar_updated=false" >> $GITHUB_OUTPUT
            echo "✗ About link NOT found in navbar"
            exit 1
          fi
      
      - name: Validation Summary
        if: success()
        run: |
          echo "✅ Lab 1 Validation Passed!"
          echo ""
          echo "✓ AboutController exists"
          echo "✓ Endpoint /about is mapped"
          echo "✓ About link added to navbar"
